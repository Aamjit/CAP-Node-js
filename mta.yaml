_schema-version: "3.1"
ID: CAP-Node-js
version: 1.0.0
description: "A simple CAP project."
parameters:
    enable-parallel-deployments: true
build-parameters:
    before-all:
        - builder: custom
          commands:
              - npm ci
              - npx cds build --production
modules:
    - name: CAP-Node-js-srv
      type: nodejs
      path: srv
      parameters:
          buildpack: nodejs_buildpack
          readiness-health-check-type: http
          readiness-health-check-http-endpoint: /health
      build-parameters:
          builder: npm
      provides:
          - name: srv-api # required by consumers of CAP services (e.g. approuter)
            properties:
                srv-url: ${default-url}
      requires:
          - name: CAP-Node-js-db

    - name: CAP-Node-js-db-deployer
      type: hdb
      path: db
      parameters:
          buildpack: nodejs_buildpack
      requires:
          - name: CAP-Node-js-db

resources:
    - name: CAP-Node-js-db
      type: com.sap.xs.hdi-container
      parameters:
          service: hana
          service-plan: hdi-shared
